<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Interactive Listening Worksheet</title>
<style>
  :root {
    --bg: #f8fafc;
    --card: #ffffff;
    --text: #111827;
    --muted: #6b7280;
    --border: #e5e7eb;
    --blue: #2563eb;
    --green: #16a34a;
    --green-bg: #ecfdf5;
    --red: #dc2626;
    --red-bg: #fef2f2;
    --shadow: 0 1px 2px rgba(0,0,0,0.06), 0 1px 3px rgba(0,0,0,0.1);
    font-synthesis-weight: none;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  }
  .container { max-width: 60rem; margin: 0 auto; padding: 2rem 1rem 4rem; }
  h1 { font-size: 1.875rem; line-height: 2.25rem; margin: 0 0 .25rem; }
  p.lead { color: var(--muted); margin: .25rem 0 0; }
  section.card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 1rem;
    padding: 1.25rem;
    margin: 1.5rem 0;
    box-shadow: var(--shadow);
  }
  h2.q {
    font-size: 1.125rem; margin: 0 0 .5rem;
    display: flex; align-items: center; justify-content: space-between;
  }
  audio { width: 100%; margin-bottom: .5rem; }
  .grid { display: grid; gap: .5rem; }
  @media (min-width: 768px) { .grid.two { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
  label.opt {
    display: flex; align-items: center; justify-content: space-between;
    gap: .75rem; border: 1px solid var(--border); border-radius: .75rem;
    padding: .75rem .875rem; background: #fff; cursor: pointer;
    transition: background .15s ease, border-color .15s ease, box-shadow .15s ease;
  }
  label.opt:hover { background: #f9fafb; }
  label.opt.correct { border-color: var(--green); background: var(--green-bg); }
  label.opt.incorrect { border-color: var(--red); background: var(--red-bg); }
  .opt-left { display: inline-flex; gap: .5rem; align-items: center; }
  .icon {
    display: inline-flex; align-items: center; justify-content: center;
    border-radius: 9999px; border: 1px solid;
    font-size: .8rem; line-height: 1; padding: .15rem .4rem;
  }
  .icon.ok { border-color: var(--green); color: var(--green); }
  .icon.no { border-color: var(--red); color: var(--red); }
  input[type="radio"] { accent-color: var(--blue); }
  input.gap {
    width: 11rem; max-width: 40vw; text-align: center;
    border: 1px solid var(--border); border-radius: .75rem; padding: .5rem .65rem;
    outline: none; transition: border-color .15s ease, background .15s ease;
    margin: 0 .25rem;
  }
  input.gap:focus { border-color: var(--blue); }
  input.gap.correct { border-color: var(--green); background: var(--green-bg); }
  input.gap.incorrect { border-color: var(--red); background: var(--red-bg); }
  .pill {
    display: inline-flex; align-items: center; gap: .5rem;
    border: 1px solid var(--border); border-radius: 999px;
    padding: .4rem .7rem; font-size: .9rem;
  }
  footer.actions { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: .75rem; margin-top: 1.5rem; }
  button.reset {
    background: #111827; color: #fff; border: none; border-radius: 1rem;
    padding: .7rem 1rem; cursor: pointer; box-shadow: var(--shadow);
  }
  button.reset:hover { background: #000; }
  .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0; }
</style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Listening Worksheet: Modals &amp; Short Responses</h1>
      <p class="lead">Listen to each clip, then answer. You’ll see immediate feedback after you choose or type.</p>
    </header>

    <!-- Q1 -->
    <section class="card" id="q1">
      <h2 class="q">1. ______ weight loss drugs help reduce the pressure on the Health Service?</h2>
      <audio controls preload="metadata" src="./audio/1.mp3" aria-label="Question 1 audio"></audio>
      <div class="grid two">
        <label class="opt"><span class="opt-left">
          <input type="radio" name="q1" value="could"><span>could</span>
        </span><span class="icon-zone"></span></label>
        <label class="opt"><span class="opt-left">
          <input type="radio" name="q1" value="couldn’t"><span>couldn’t</span>
        </span><span class="icon-zone"></span></label>
      </div>
    </section>

    <!-- Q2 -->
    <section class="card" id="q2">
      <h2 class="q">2. You think children who are overweight ______ be given these weight-loss jabs.</h2>
      <audio controls preload="metadata" src="./audio/2.mp3" aria-label="Question 2 audio"></audio>
      <div class="grid two">
        <label class="opt"><span class="opt-left">
          <input type="radio" name="q2" value="should"><span>should</span>
        </span><span class="icon-zone"></span></label>
        <label class="opt"><span class="opt-left">
          <input type="radio" name="q2" value="shouldn’t"><span>shouldn’t</span>
        </span><span class="icon-zone"></span></label>
      </div>
    </section>

    <!-- Q3 -->
    <section class="card" id="q3">
      <h2 class="q">3. I'm absolutely ____ saying that these are for everybody, but to me, we always need to be looking at lifestyle measures...</h2>
      <audio controls preload="metadata" src="./audio/3.mp3" aria-label="Question 3 audio"></audio>
      <div>
        <label class="sr-only" for="q3gap1">Type the missing word</label>
        <input id="q3gap1" class="gap" placeholder="_____" data-gap="3-0" />
        <span class="icon-zone"></span>
      </div>
    </section>

    <!-- Q4 -->
    <section class="card" id="q4">
      <h2 class="q">4. I'm not saying that lifestyle measures ________ be in place</h2>
      <audio controls preload="metadata" src="./audio/4.mp3" aria-label="Question 4 audio"></audio>
      <div class="grid two">
        <label class="opt"><span class="opt-left">
          <input type="radio" name="q4" value="should"><span>should</span>
        </span><span class="icon-zone"></span></label>
        <label class="opt"><span class="opt-left">
          <input type="radio" name="q4" value="shouldn’t"><span>shouldn’t</span>
        </span><span class="icon-zone"></span></label>
      </div>
    </section>

    <!-- Q5 -->
    <section class="card" id="q5">
      <h2 class="q">5.</h2>
      <audio controls preload="metadata" src="./audio/5.mp3" aria-label="Question 5 audio"></audio>

      <p>
        <input class="gap" placeholder="_____" data-gap="5-0" /> part of the problem Thorrun,
        <input class="gap" placeholder="_____" data-gap="5-1" /> it? just briefly because we're running out of time it…
        <input class="gap" placeholder="_____" data-gap="5-2" /> have to stay on it…
      </p>

      <p>
        You <input class="gap" placeholder="_____" data-gap="5-3" /> have to stay on it, you
        <input class="gap" placeholder="_____" data-gap="5-4" /> learn some really helpful lifestyle measures,
        <input class="gap" placeholder="_____" data-gap="5-5" /> get yourself back to a place where you felt confident enough to carry on with those lifestyle measures…
      </p>

      <div class="overall5"></div>
    </section>

    <footer class="actions">
      <button class="reset" id="resetBtn">Reset answers</button>
      <div class="pill">Score: <strong id="score">0</strong> / 5</div>
    </footer>
  </div>

<script>
// ---------- Answer Key & Helpers ----------
const ANSWERS = {
  1: { type: "mcq", correct: "could" },
  2: { type: "mcq", correct: "shouldn’t" },
  3: { type: "gap", blanks: [ ["not"] ] },
  4: { type: "mcq", correct: "should" },
  5: {
    type: "multiGap",
    blanks: [
      ["is that","is it", "is  that"],    // 5-0
      ["isn’t","isn't"],                  // 5-1
      ["you don’t","you don't","you do not"], // 5-2
      ["don’t","don't","do not"],         // 5-3
      ["could","can"],                    // 5-4
      ["and"]                             // 5-5
    ]
  }
};

function norm(s){ return (s ?? "").toString().trim().toLowerCase(); }
function isMatch(user, acceptable){
  const v = norm(user);
  for (const acc of acceptable){
    if (acc instanceof RegExp){ if (acc.test(v)) return true; }
    else if (norm(acc) === v) return true;
  }
  return false;
}

function setIcon(zone, ok){
  zone.innerHTML = "";
  if (ok === null) return;
  const span = document.createElement("span");
  span.className = "icon " + (ok ? "ok" : "no");
  span.setAttribute("aria-label", ok ? "correct" : "incorrect");
  span.textContent = ok ? "✓" : "✗";
  zone.appendChild(span);
}

// ---------- MCQ Logic ----------
function setupMCQ(qId){
  const section = document.getElementById("q" + qId);
  const correct = norm(ANSWERS[qId].correct);
  const labels = section.querySelectorAll("label.opt");

  labels.forEach(label => {
    const radio = label.querySelector('input[type="radio"]');
    const iconZone = label.querySelector('.icon-zone');

    radio.addEventListener("change", () => {
      // clear state on all
      labels.forEach(l => {
        l.classList.remove("correct","incorrect");
        setIcon(l.querySelector('.icon-zone'), null);
      });

      const chosen = norm(radio.value);
      const ok = chosen === correct;
      label.classList.add(ok ? "correct" : "incorrect");
      setIcon(iconZone, ok);
      updateScore();
    });
  });
}

// ---------- Gap Logic ----------
function setupGap(qId){
  const section = document.getElementById("q" + qId);
  const inputs = section.querySelectorAll('input.gap');
  const ans = ANSWERS[qId];

  inputs.forEach((inp, idx) => {
    const zone = document.createElement("span");
    zone.className = "icon-zone";
    inp.insertAdjacentElement("afterend", zone);

    function validate(){
      const acceptable = ans.blanks[idx];
      const ok = inp.value.trim() ? isMatch(inp.value, acceptable) : null;
      inp.classList.toggle("correct", ok === true);
      inp.classList.toggle("incorrect", ok === false);
      setIcon(zone, ok);
      updateScore();
    }

    inp.addEventListener("input", validate);
    inp.addEventListener("blur", validate);
  });
}

// Q5 overall indicator (optional aggregate)
function setupQ5Overall(){
  const section = document.getElementById("q5");
  const inputs = section.querySelectorAll('input.gap');
  const overall = section.querySelector('.overall5');

  function updateOverall(){
    let anyFilled = false;
    let allCorrect = true;
    inputs.forEach((inp, i) => {
      const acceptable = ANSWERS[5].blanks[i];
      const filled = inp.value.trim().length > 0;
      const ok = filled ? isMatch(inp.value, acceptable) : null;
      if (filled) anyFilled = true;
      if (ok !== true) allCorrect = false;
    });
    if (!anyFilled){ overall.innerHTML = ""; return; }
    overall.innerHTML = '<span class="pill" style="margin-top:.5rem;"><span style="color:'
      + (allCorrect? 'var(--green)':'var(--red)')
      + ';">' + (allCorrect? 'All blanks correct' : 'Some blanks are incorrect') + '</span></span>';
  }

  inputs.forEach(inp => inp.addEventListener("input", updateOverall));
  inputs.forEach(inp => inp.addEventListener("blur", updateOverall));
}

// ---------- Score & Reset ----------
function isQ1Correct(){
  const chosen = document.querySelector('#q1 input[type="radio"]:checked');
  return chosen && norm(chosen.value) === norm(ANSWERS[1].correct);
}
function isQ2Correct(){
  const chosen = document.querySelector('#q2 input[type="radio"]:checked');
  return chosen && norm(chosen.value) === norm(ANSWERS[2].correct);
}
function isQ3Correct(){
  const v = document.querySelector('#q3 input.gap').value;
  return v.trim() && isMatch(v, ANSWERS[3].blanks[0]);
}
function isQ4Correct(){
  const chosen = document.querySelector('#q4 input[type="radio"]:checked');
  return chosen && norm(chosen.value) === norm(ANSWERS[4].correct);
}
function isQ5Correct(){
  const inputs = document.querySelectorAll('#q5 input.gap');
  return Array.from(inputs).every((inp, i) => inp.value.trim() && isMatch(inp.value, ANSWERS[5].blanks[i]));
}
function updateScore(){
  const values = [isQ1Correct(), isQ2Correct(), isQ3Correct(), isQ4Correct(), isQ5Correct()];
  const correct = values.filter(Boolean).length;
  document.getElementById("score").textContent = correct;
}

function resetAll(){
  // Radios
  document.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
  document.querySelectorAll('label.opt').forEach(l => {
    l.classList.remove('correct','incorrect');
    setIcon(l.querySelector('.icon-zone'), null);
  });
  // Gaps
  document.querySelectorAll('input.gap').forEach(inp => {
    inp.value = "";
    inp.classList.remove('correct','incorrect');
    const zone = inp.parentElement.querySelector('.icon-zone');
    if (zone) zone.innerHTML = "";
  });
  const overall = document.querySelector('#q5 .overall5');
  if (overall) overall.innerHTML = "";
  updateScore();
}

// ---------- Init ----------
setupMCQ(1);
setupMCQ(2);
setupMCQ(4);
setupGap(3);
setupGap(5);
setupQ5Overall();
updateScore();

document.getElementById("resetBtn").addEventListener("click", resetAll);
</script>
</body>
</html>
